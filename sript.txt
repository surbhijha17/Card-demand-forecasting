<!DOCTYPE html>
<html>
<head>
    <title>Audio Transcription</title>
</head>
<body>
    <button id="start">Start Recording</button>
    <button id="stop">Stop Recording</button>
    <div id="transcription"></div>

    <script>
        const startButton = document.getElementById('start');
        const stopButton = document.getElementById('stop');
        const transcriptionDiv = document.getElementById('transcription');

        let recorder;
        let socket;

        startButton.addEventListener('click', () => {
            navigator.mediaDevices.getUserMedia({ audio: true })
                .then(stream => {
                    recorder = new MediaRecorder(stream);
                    recorder.start();

                    socket = new WebSocket('ws://localhost:8765');
                    socket.onopen = () => {
                        recorder.ondataavailable = (event) => {
                            socket.send(event.data);
                        };
                    };
                    socket.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        transcriptionDiv.textContent += data.text + ' ';
                    };
                });
        });

        stopButton.addEventListener('click', () => {
            recorder.stop();
            socket.close();
        });
    </script>
</body>
</html>
