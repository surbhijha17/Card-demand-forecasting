import pandas as pd
from openpyxl import load_workbook

# Assuming you have n dataframes named df1, df2, ..., dfn

# List of dataframes
dataframes = [df1, df2, df3, df4, df5, df6]  # Add more dataframes as needed

# Load the existing Excel file
excel_file = 'existing.xlsx'  # Replace 'existing.xlsx' with your existing file name
book = load_workbook(excel_file)
writer = pd.ExcelWriter(excel_file, engine='openpyxl')
writer.book = book

# Starting row and column index
start_row = 1
start_col = 1

# Counter to keep track of current dataframe
counter = 0

# Loop through dataframes two at a time
while counter < len(dataframes):
    # Concatenate two dataframes horizontally
    df_concat = pd.concat([dataframes[counter], dataframes[counter+1]], axis=1)
    
    # Write the concatenated dataframe to Excel
    df_concat.to_excel(writer, sheet_name='Sheet1', startrow=start_row, startcol=start_col, index=False, header=False)
    
    # Increment row for the next pair of dataframes
    start_row += max(dataframes[counter].shape[0], dataframes[counter+1].shape[0]) + 1
    
    # Increment counter
    counter += 2

# Save changes to the Excel file
writer.save()
