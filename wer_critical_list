import pandas as pd
from openpyxl import load_workbook

# Load the Excel template into a DataFrame
excel_file = "template.xlsx"
df = pd.read_excel(excel_file)

# Make updates to the DataFrame
# For example, let's change the value in the first row and first column
df.at[0, 'Column1'] = 'New Value'

# Load the Excel template for styling
wb = load_workbook(excel_file)
sheet = wb.active
styles = {}
for row in sheet.iter_rows(min_row=2, max_row=sheet.max_row, min_col=1, max_col=sheet.max_column):
    for cell in row:
        styles[(cell.row, cell.column)] = cell.style

# Apply styling to the updated DataFrame
styled_df = df.style
for (row, col), style in styles.items():
    styled_df = styled_df.applymap(lambda x: style if df.index[row - 1] == x else None, subset=pd.IndexSlice[row - 1, col - 1])

# Save the updated DataFrame with styling to a new Excel file
output_file = "updated_template.xlsx"
with pd.ExcelWriter(output_file, engine='openpyxl') as writer:
    styled_df.to_excel(writer, index=False, sheet_name='Sheet1')
    writer.save()
