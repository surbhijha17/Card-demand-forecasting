import win32com.client

def copy_excel_to_powerpoint(excel_file_path, pptx_file_path, slide_index=1):
    # Connect to Excel
    excel_app = win32com.client.Dispatch("Excel.Application")
    excel_app.Visible = True  # Set to True to make Excel visible

    # Open the Excel workbook
    workbook = excel_app.Workbooks.Open(excel_file_path)

    # Connect to PowerPoint
    ppt_app = win32com.client.Dispatch("PowerPoint.Application")
    ppt_app.Visible = True  # Set to True to make PowerPoint visible

    # Open the PowerPoint presentation
    presentation = ppt_app.Presentations.Open(pptx_file_path)

    # Copy the Excel worksheet
    workbook.Worksheets(1).Activate()
    workbook.Worksheets(1).Cells.Select()
    workbook.ActiveSheet.UsedRange.Copy()

    # Paste the content into the PowerPoint slide
    slide = presentation.Slides(slide_index)
    slide.Shapes.PasteSpecial(DataType=10)  # DataType 10 is for Microsoft Excel Worksheet Object

    # Save and close the PowerPoint presentation
    presentation.Save()
    presentation.Close()

    # Quit both Excel and PowerPoint applications
    excel_app.Quit()
    ppt_app.Quit()

# Example usage
excel_file_path = 'path_to_your_excel_file.xlsx'
pptx_file_path = 'path_to_your_pptx_file.pptx'
copy_excel_to_powerpoint(excel_file_path, pptx_file_path)
